<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="小龙仔">
<meta property="og:type" content="website">
<meta property="og:title" content="long">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="long">
<meta property="og:description" content="小龙仔">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="long">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>long</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">long</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/03/20/%E9%9B%B6%E7%A2%8E%E7%9A%84%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="long">
      <meta itemprop="description" content="小龙仔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="long">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/20/%E9%9B%B6%E7%A2%8E%E7%9A%84%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">零碎的小程序笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-20 13:34:00" itemprop="dateCreated datePublished" datetime="2020-03-20T13:34:00+08:00">2020-03-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>template的简单使用<br>WXS的简单使用<br>npm的简单使用<br>倒计时js的实现<br><code>wx:for</code>的使用<br>一些js方法记录<br>wxss记录</p>
<h3 id="template的简单使用"><a href="#template的简单使用" class="headerlink" title="template的简单使用"></a>template的简单使用</h3><p>创建一个page，在<code>.wxml</code>、<code>.wxss</code>中正常编写页面和样式代码，其中在<code>.wxml</code>中加入<code>&lt;template&gt;</code>标签如下：<code>my_template.wxml</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template name&#x3D;&quot;my-first-template&quot;&gt;</span><br><span class="line">  &lt;view&gt;&#123;&#123;myData&#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>
<p>在需要用到该模板的<code>wxml</code>页面，引入模板并使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 引用模板文件</span><br><span class="line">&lt;import src&#x3D;&quot;..&#x2F;my_template&#x2F;my_template.wxml&quot; &#x2F;&gt;</span><br><span class="line">&#x2F;&#x2F; 使用模板</span><br><span class="line">&lt;template is&#x3D;&quot;my-first-template&quot; data&#x3D;&quot;&#123;&#123;myData&#125;&#125;&quot;&gt;&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>
<p>在对应的<code>.wxss</code>文件也要引入对应的模板样式文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;..&#x2F;my_template&#x2F;my_template.wxss&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="WXS的简单使用"><a href="#WXS的简单使用" class="headerlink" title="WXS的简单使用"></a>WXS的简单使用</h3><p>新建一个<code>.wxs</code>后缀的文件，编写代码，这里以一个截取字符串为案例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var subString &#x3D; function(str, start, end) &#123;</span><br><span class="line">  if (str.length &#x3D;&#x3D; 0 || str &#x3D;&#x3D; undefined) return;</span><br><span class="line">  if (start &gt; end || str.length &lt; end) return str;</span><br><span class="line"></span><br><span class="line">  if (start !&#x3D; undefined &amp;&amp; end !&#x3D; undefined) &#123;</span><br><span class="line">    return str.substring(start, end)</span><br><span class="line">  &#125;</span><br><span class="line">  return str</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 暴露接口</span><br><span class="line">module.exports.subString &#x3D; subString;</span><br></pre></td></tr></table></figure>
<p>在<code>.wxml</code>文件中使用wxs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- &#39;tools&#39;是在该页面使用wxs的名字，可以自定义 --&gt;</span><br><span class="line">&lt;wxs src&#x3D;&quot;..&#x2F;utils&#x2F;substring.wxs&quot; module&#x3D;&quot;tools&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;text&gt;&#123;&#123;tools.subString(&quot;ABCDEFG&quot;)&#125;&#125;&lt;&#x2F;text&gt;</span><br></pre></td></tr></table></figure>
<p>如果是将<code>wxs</code>的代码直接写在<code>.wxml</code>中，则要在<code>wxs</code>代码中就对其命名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;text&gt;&#123;&#123;tools.subString(&quot;ABCDEFG&quot;)&#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line"></span><br><span class="line">&lt;wxs module&#x3D;&quot;tools&quot;&gt;</span><br><span class="line">  var subString &#x3D; function(str, start, end) &#123;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; 暴露接口</span><br><span class="line">  module.exports.subString &#x3D; subString;</span><br><span class="line">&lt;&#x2F;wxs&gt;</span><br></pre></td></tr></table></figure>


<h3 id="npm的简单使用"><a href="#npm的简单使用" class="headerlink" title="npm的简单使用"></a>npm的简单使用</h3><p>以安装小程序的 MobX 绑定辅助库为例<br>在命令行中定位到小程序项目根目录按顺序执行以下命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install --save mobx-miniprogram mobx-miniprogram-bindings</span><br></pre></td></tr></table></figure>
<p>执行完成后根目录会生成<code>node_modules</code>文件夹，依赖的代码就在里面。<br>然后在微信开发者工具点击 <code>工具</code> - <code>构建npm</code> ，开发者工具会将依赖构建到<code>miniprogram_npm</code>文件夹，这样就可以使用相关的模块了。<br>使用<code>git</code>管理时可以不必上传<code>miniprogram_npm</code>和<code>node_modules</code>文件夹内的文件，只需在下载项目后执行<code>npm install</code>再<code>构建npm</code>即可。</p>
<h2 id="倒计时js的实现"><a href="#倒计时js的实现" class="headerlink" title="倒计时js的实现"></a>倒计时js的实现</h2><p>传入毫秒开始倒计时，如传入 10*1000 == 10000ms 即为10秒倒计时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; utils.js</span><br><span class="line">const countDown &#x3D; function(time) &#123;</span><br><span class="line">  let day &#x3D; parseInt(time &#x2F; 1000 &#x2F; 60 &#x2F; 60 &#x2F; 60 &#x2F; 24);</span><br><span class="line">  let hour &#x3D; parseInt(time &#x2F; 1000 &#x2F; 60 &#x2F; 60 &#x2F; 60 % 24);</span><br><span class="line">  let minute &#x3D; parseInt(time &#x2F; 1000 &#x2F; 60 % 60);</span><br><span class="line">  let second &#x3D; parseInt(time &#x2F; 1000 % 60);</span><br><span class="line"></span><br><span class="line">  var timeMap &#x3D; &#123;</span><br><span class="line">    day: timeFormat(day),</span><br><span class="line">    hour: timeFormat(hour),</span><br><span class="line">    minute: timeFormat(minute),</span><br><span class="line">    second: timeFormat(second)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return timeMap</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; &#x2F;&#x2F;小于10的格式化函数（2变成02）</span><br><span class="line">function timeFormat(param) &#123;</span><br><span class="line">  return param &lt; 10 ? &#39;0&#39; + param : param;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在页面js中的使用方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  data: &#123;</span><br><span class="line">    totalTime: 10 * 1000, &#x2F;&#x2F; 10秒倒计时</span><br><span class="line">    timer: &#39;&#39;, &#x2F;&#x2F; 定时器</span><br><span class="line">    hours: &#39;&#39;,</span><br><span class="line">    minute: &#39;&#39;,</span><br><span class="line">    second: &#39;&#39;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">countDown: function() &#123;</span><br><span class="line">    if (this.data.totalTime &gt;&#x3D; 0) &#123;</span><br><span class="line">      let map &#x3D; utils.countDown(this.data.totalTime)</span><br><span class="line">      this.setData(&#123;</span><br><span class="line">        hour: map.hour,</span><br><span class="line">        minute: map.minute,</span><br><span class="line">        second: map.second</span><br><span class="line">      &#125;)</span><br><span class="line">      this.data.totalTime &#x3D; this.data.totalTime - 1000</span><br><span class="line">      this.data.timer &#x3D; setTimeout(this.countDown, 1000);</span><br><span class="line">    &#125; else&#123;</span><br><span class="line">      &#x2F;&#x2F; 时间到的处理</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#x2F;&#x2F; 退出该页面时要取消定时器，否则还会继续倒计时</span><br><span class="line"> onUnload: function() &#123;</span><br><span class="line">    clearTimeout(this.data.timer)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<h2 id="wx-for的使用"><a href="#wx-for的使用" class="headerlink" title="wx:for的使用"></a>wx:for的使用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 循环list数组，wx:for-item是对数组内对象重命名，不加默认为item--&gt;</span><br><span class="line">&lt;!-- 循环list数组，wx:for-index是对数组内下标重命名，不加默认为index--&gt;</span><br><span class="line">&lt;block wx:for&#x3D;&quot;&#123;&#123;list&#125;&#125;&quot; wx:for-item&#x3D;&quot;newName&quot; wx:for-index&#x3D;&quot;newIndex&quot;&gt;</span><br><span class="line">  &lt;text&gt;&#123;&#123;newName.text&#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">  &lt;text&gt;&#123;&#123;list[newIndex].text&#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">&lt;&#x2F;block&gt;</span><br></pre></td></tr></table></figure>
<h2 id="一些js的方法记录"><a href="#一些js的方法记录" class="headerlink" title="一些js的方法记录"></a>一些js的方法记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 获取路径中的文件名</span><br><span class="line">&#x2F;&#x2F; eg. var str &#x3D; &#39;a&#x2F;b&#x2F;c.jpg&#39;</span><br><span class="line">&#x2F;&#x2F; basename(str)  返回 c.jpg</span><br><span class="line">function basename(str) &#123;</span><br><span class="line">  var idx &#x3D; str.lastIndexOf(&#39;&#x2F;&#39;)</span><br><span class="line">  idx &#x3D; idx &gt; -1 ? idx : str.lastIndexOf(&#39;\\&#39;)</span><br><span class="line">  if (idx &lt; 0) &#123;</span><br><span class="line">    return str</span><br><span class="line">  &#125;</span><br><span class="line">  return str.substring(idx + 1);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 返回路径中的文件名，不带后缀</span><br><span class="line">&#x2F;&#x2F; eg. var str &#x3D; &#39;a&#x2F;b&#x2F;c.jpg&#39;</span><br><span class="line">&#x2F;&#x2F; splitFileName(str)  返回c</span><br><span class="line">function splitFileName(text) &#123;</span><br><span class="line">  var pattern &#x3D; &#x2F;\.&#123;1&#125;[a-z]&#123;1,&#125;$&#x2F;;</span><br><span class="line">  if (pattern.exec(text) !&#x3D;&#x3D; null) &#123;</span><br><span class="line">    return (text.slice(0, pattern.exec(text).index));</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    return text;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; string转map</span><br><span class="line">var str &#x3D; &#39;&#123;&quot;name&quot;:&quot;张三&quot;,&quot;age&quot;:&quot;16&quot;&#125;&#39;</span><br><span class="line">var map &#x3D; JSON.parse(str)</span><br><span class="line">&#x2F;&#x2F; 向数组增加元素</span><br><span class="line">var myList &#x3D; [1,3,5]</span><br><span class="line">myList.push(7) &#x2F;&#x2F; [1,3,5,7]  添加到数组末尾</span><br><span class="line">myList.unshift(4) &#x2F;&#x2F; [4,1,3,5,7]  添加到第0个位置</span><br><span class="line">myList.splice(2,1) &#x2F;&#x2F; [4,1,5,7]  删除数组下标第2个元素</span><br><span class="line">&#x2F;&#x2F; myList.splice(a,b)  从数组下标为a的元素开始(包括a)删除b个元素</span><br></pre></td></tr></table></figure>
<h2 id="wxss记录"><a href="#wxss记录" class="headerlink" title="wxss记录"></a>wxss记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flex-grow: 0; &#x2F;* 放大比例，0是不放大*&#x2F;</span><br><span class="line">flex-shrink: 0; &#x2F;* 缩小比例,0是不缩小 *&#x2F;</span><br><span class="line">box-shadow: 0rpx 0rpx 5rpx 5rpx #d3d3d3; &#x2F;* 水平位移、垂直位移、模糊程度、阴影半径、颜色*&#x2F;</span><br></pre></td></tr></table></figure>
<p>显示2行文字，多余的省略号显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">width: 500rpx;&#x2F;*可选*&#x2F;</span><br><span class="line">text-overflow: ellipsis;</span><br><span class="line">overflow: hidden;</span><br><span class="line">display: -webkit-box;</span><br><span class="line">-webkit-line-clamp: 2; &#x2F;* 2行 *&#x2F;</span><br><span class="line">-webkit-box-orient: vertical;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/11/flutter%20mobx%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="long">
      <meta itemprop="description" content="小龙仔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="long">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/11/flutter%20mobx%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">flutter mobx状态管理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-06-11 18:08:52" itemprop="dateCreated datePublished" datetime="2019-06-11T18:08:52+08:00">2019-06-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span></span><br><span class="line">  <span class="attr">mobx:</span> <span class="string">^0.1.4</span></span><br><span class="line">  <span class="attr">flutter_mobx:</span> <span class="string">^0.1.3</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dev_dependencies:</span></span><br><span class="line">  <span class="attr">mobx_codegen:</span> <span class="string">^0.1.3</span></span><br><span class="line">  <span class="attr">build_runner:</span> <span class="string">^1.4.0</span></span><br></pre></td></tr></table></figure>
<h2 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h2><p>以计数例子为例，创建一个<code>counter.dart</code>文件，代码如下：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:mobx/mobx.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">part</span> <span class="string">&#x27;counter.g.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> = <span class="title">CounterBase</span> <span class="title">with</span> <span class="title">_</span>$<span class="title">Counter</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">final</span> <span class="title">Counter</span> <span class="title">counter</span> = <span class="title">Counter</span>();</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">abstract</span> <span class="title">class</span> <span class="title">CounterBase</span> <span class="keyword">implements</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">  <span class="meta">@observable</span></span><br><span class="line">  <span class="built_in">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@action</span></span><br><span class="line">  <span class="keyword">void</span> add() &#123;</span><br><span class="line">    count++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@action</span></span><br><span class="line">  <span class="keyword">void</span> minus() &#123;</span><br><span class="line">    count--;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@action</span></span><br><span class="line">  <span class="keyword">void</span> setCount(<span class="built_in">int</span> value) &#123;</span><br><span class="line">    <span class="keyword">this</span>.count = value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@computed</span></span><br><span class="line">  <span class="built_in">bool</span> <span class="keyword">get</span> isEven =&gt; count % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于以上代码的解释：<br><code>@observable</code> 可观察对象，需要在UI层显示的数据可以这样定义。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@observable</span></span><br><span class="line"> <span class="built_in">int</span> count = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p><code>@action</code> 操作方法，要对可观察对象的值进行更改时，都应该在<code>@action</code>修饰发方法中进行修改，业务代码的操作也是在这个注解下的方法进行。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@action</span></span><br><span class="line"><span class="keyword">void</span> add() &#123;</span><br><span class="line">   count++;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><code>@computed</code> 计算，基于<code>@observable</code>来计算其值的函数，如计算count值是否是偶数，在list中筛选特定条件下的子项等。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@computed</span></span><br><span class="line"><span class="built_in">bool</span> <span class="keyword">get</span> isEven =&gt; count % <span class="number">2</span> == <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>注意：必须包含以下两行代码，才可以生成<code>counter.g.dart</code>文件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">part</span> <span class="string">&#x27;counter.g.dart&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> = <span class="title">CounterBase</span> <span class="title">with</span> <span class="title">_</span>$<span class="title">Counter</span>;</span></span><br></pre></td></tr></table></figure>
<p>在命令行中执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter packages pub run build_runner build</span><br></pre></td></tr></table></figure>
<p>完成后将会生成<code>counter.g.dart</code>文件<br>执行一下命令，可以实现<code>counter.g.dart</code>文件的动态生成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter packages pub run build_runner watch</span><br></pre></td></tr></table></figure>
<p>即修改<code>counter.dart</code>文件后 ctrl + s（热重载）即可重新生成。</p>
<h2 id="数值显示"><a href="#数值显示" class="headerlink" title="数值显示"></a>数值显示</h2><p>在需要显示<code>count</code>值的时候，使用如下代码：<br><code>Observer(builder: (_) =&gt; Text(&#39;$&#123;counter.count&#125;&#39;)),</code><br><code>Observer</code>是一个观察者，继承了<code>StatefulWidget</code>，将要观察的组件放置在里面，就能实现对该组件的状态管理。</p>
<h2 id="数值操作"><a href="#数值操作" class="headerlink" title="数值操作"></a>数值操作</h2><p>在<code>counter.dart</code>中有<code>add()</code>、<code>minus()</code>和<code>setCount()</code>三个方法对<code>count</code>的值进行修改。可在按钮的点击事件中调用相关方法进行修改，如下：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RaisedButton(</span><br><span class="line">  child: Text(<span class="string">&#x27;加&#x27;</span>),</span><br><span class="line">  onPressed: counter.add,</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<p>以上就是flutter mobx的简单使用方法。<br>完整代码案例详见GitHub：<a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_state_management">https://github.com/huang-weilong/flutter_state_management</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/05/flutter%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5APP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="long">
      <meta itemprop="description" content="小龙仔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="long">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/05/flutter%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5APP/" class="post-title-link" itemprop="url">flutter天气预报APP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-06-05 13:42:31" itemprop="dateCreated datePublished" datetime="2019-06-05T13:42:31+08:00">2019-06-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这是一个使用flutter写的天气预报APP，主要使用了以下几个插件，入门级练练手。<br><code>dio</code>:网络请求插件，用于获取天气信息<br><code>fluttertoast</code>:弹出toast提示信息<br><code>shared_preferences</code>:简单的数据存储，用于保存设置过的天气预报信息<br><code>intl</code>:日期格式化<br><code>fluttertoast</code>:提示信息<br><code>mobx</code>:状态管理<br><code>flutter_mobx</code>:状态管理<br><code>easy_localization</code>:国际化<br><code>mobx_codegen</code>:状态管理自动生成代码的依赖<br><code>build_runner</code>:自动生成代码依赖<br>项目GitHub地址：<a href="%5Bhttps://github.com/huang-weilong/d9l_weather%5D(https://github.com/huang-weilong/d9l_weather)">d9l_weather</a></p>
<h2 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h2><p>首先搜集一些天气预报APP的设计稿，确定一下自己的界面。看到有很多好看的，但是并不想做的太复杂。为了省事就找了一个模仿一下，下面是实现的效果图：<br><img src="https://upload-images.jianshu.io/upload_images/13443233-a98d104f3b29a8f0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="首页图"></p>
<p>然后分析一下这个页面，大主体就是一个列布局（Column），中间穿插行布局（Row）。详细的布局这里就不写，可以在这查看源码<a target="_blank" rel="noopener" href="https://github.com/huang-weilong/d9l_weather/blob/master/lib/pages/home_page.dart">home_page.dart</a></p>
<p>界面堆好之后，再做一个搜索城市的页面，一个搜索框加列表就可以了，怎么简单怎么来。页面通过右上角的设置按钮进入。</p>
<h2 id="API接口调用"><a href="#API接口调用" class="headerlink" title="API接口调用"></a>API接口调用</h2><p>页面都写好之后就需要把数据替换成真实数据了，这里使用了<a target="_blank" rel="noopener" href="https://www.heweather.com/">和风天气</a>的API获取天气数据，注册之后就能使用。但是普通用户有些接口是不能用的，但是对这个APP来说，能够查到天气信息、最近三天和生活指数这些信息就足够了。<br>要请求接口，这里使用<code>dio</code>插件来实现。使用单例模式即可。<br>新建一个<code>http.dart</code>文件，简单写一下get和post方法，如下。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dio/dio.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Http</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Dio dio;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">factory</span> Http() =&gt; _getInstance();</span><br><span class="line">  <span class="keyword">static</span> Http <span class="keyword">get</span> instance =&gt; _getInstance();</span><br><span class="line">  <span class="keyword">static</span> Http _instance; <span class="comment">// 单例对象</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> Http _getInstance() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">      _instance = Http._internal();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Http._internal() &#123;</span><br><span class="line">    dio = Dio(BaseOptions(connectTimeout: <span class="number">60000</span>, receiveTimeout: <span class="number">15000</span>, sendTimeout: <span class="number">15000</span>));</span><br><span class="line">    dio.options.baseUrl = rootUrl;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> rootUrl = <span class="string">&#x27;https://free-api.heweather.net/s6&#x27;</span>;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> key = <span class="string">&#x27;d77fe2f561f44c1b8a8d365ad503e9bf&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  Future <span class="keyword">get</span>(<span class="built_in">String</span> path, <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; params) <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Response response = <span class="keyword">await</span> dio.<span class="keyword">get</span>(path, queryParameters: params);</span><br><span class="line">      <span class="keyword">return</span> response.data;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="built_in">print</span>(e);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Future post(<span class="built_in">String</span> path, <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; data) <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Response response = <span class="keyword">await</span> dio.post(path, data: data);</span><br><span class="line">      <span class="keyword">return</span> response.data;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用方法，传入请求地址和参数即可</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Http().<span class="keyword">get</span>(<span class="string">&#x27;/weather/now&#x27;</span>, &#123;</span><br><span class="line">      <span class="string">&#x27;location&#x27;</span>: cid,</span><br><span class="line">      <span class="string">&#x27;lang&#x27;</span>: D9l().lang,</span><br><span class="line">      <span class="string">&#x27;key&#x27;</span>: Http.key,</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>如获取实时天气的方法如下：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实况天气</span></span><br><span class="line"> Future _getNow() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">await</span> Http().<span class="keyword">get</span>(<span class="string">&#x27;/weather/now&#x27;</span>, &#123;</span><br><span class="line">      <span class="string">&#x27;location&#x27;</span>: cid,</span><br><span class="line">      <span class="string">&#x27;lang&#x27;</span>: D9l().lang,</span><br><span class="line">      <span class="string">&#x27;key&#x27;</span>: Http.key,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result != <span class="keyword">null</span>) &#123;</span><br><span class="line">      status = result[<span class="string">&#x27;HeWeather6&#x27;</span>].first[<span class="string">&#x27;status&#x27;</span>];</span><br><span class="line">      <span class="keyword">if</span> (status == <span class="string">&#x27;ok&#x27;</span>) &#123;</span><br><span class="line">        basic = Basic.fromJson(result[<span class="string">&#x27;HeWeather6&#x27;</span>].first[<span class="string">&#x27;basic&#x27;</span>]);</span><br><span class="line">        update = Update.fromJson(result[<span class="string">&#x27;HeWeather6&#x27;</span>].first[<span class="string">&#x27;update&#x27;</span>]);</span><br><span class="line">        now = Now.fromJson(result[<span class="string">&#x27;HeWeather6&#x27;</span>].first[<span class="string">&#x27;now&#x27;</span>]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="shared-preferences"><a href="#shared-preferences" class="headerlink" title="shared_preferences"></a>shared_preferences</h2><p>在搜索完一个城市的天气后，需要把这个城市的<code>id</code>保存在<code>shared_preferences</code>中，这样关闭app下次再打开的时候才能显示上一次查询的城市天气，或者需要保存多个城市天气预报的时候，也可以保存。<br>保存只需要一行代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SpClient.sp.setString(<span class="string">&#x27;cid&#x27;</span>, cid);</span><br></pre></td></tr></table></figure>
<p><code>shared_preferences</code>的使用也是使用了单例模式，和<code>http.dart</code>一样</p>
<h2 id="国际化"><a href="#国际化" class="headerlink" title="国际化"></a>国际化</h2><p>本项目使用了<code>easy_localization</code>插件来实现，个人觉得这还是一个比较简单好上手的一个插件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">runApp(EasyLocalization(child: MyApp()));</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">var</span> data = EasyLocalizationProvider.of(context).data;</span><br><span class="line">    <span class="keyword">return</span> EasyLocalizationProvider(</span><br><span class="line">      data: data,</span><br><span class="line">      child: MaterialApp(</span><br><span class="line">        title: <span class="string">&#x27;d9l weather&#x27;</span>,</span><br><span class="line">        localizationsDelegates: [</span><br><span class="line">          GlobalMaterialLocalizations.delegate,</span><br><span class="line">          GlobalWidgetsLocalizations.delegate,</span><br><span class="line">          EasylocaLizationDelegate(</span><br><span class="line">            locale: data.locale,</span><br><span class="line">            path: <span class="string">&#x27;assets/langs&#x27;</span>, <span class="comment">// 多语言路径</span></span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">        supportedLocales: [Locale(<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;US&#x27;</span>), Locale(<span class="string">&#x27;zh&#x27;</span>, <span class="string">&#x27;CN&#x27;</span>)],</span><br><span class="line">        locale: data.savedLocale,</span><br><span class="line">        theme: ThemeData(</span><br><span class="line">          primarySwatch: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">        home: HomePage(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">````</span><br><span class="line">然后编写自己的国际json文件，放在`assets/langs`路径下，并且在`pubspec.yaml`中进行声明，并在`Text`组件中这样使用`AppLocalizations.of(context).tr(<span class="string">&#x27;wind&#x27;</span>)`，wind是你在json中使用的key，它会根据当前的语言显示。</span><br><span class="line">切换语言也很简单</span><br><span class="line">```dart</span><br><span class="line"><span class="keyword">var</span> data = EasyLocalizationProvider.of(context).data;</span><br><span class="line">data.changeLocale(Locale(<span class="string">&quot;zh&quot;</span>, <span class="string">&quot;CN&quot;</span>));</span><br></pre></td></tr></table></figure>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>这个项目很简单，也只是用了很少的东西，主要是练练手吧。也没太多东西能够介绍的。后面有时间的话会继续完善。感兴趣的可以关注一下。GitHub给star支持，谢谢！<br>最后再放一下本项目的GitHub地址 <a target="_blank" rel="noopener" href="https://github.com/huang-weilong/d9l_weather">d9l_weather</a></p>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>文章于2020.3.23日晚更新，对界面进行了重新排版，项目整体都做了较大改变，并且新增了国际化、状态管理。继续完善中~</p>
<h3 id="其他项目"><a href="#其他项目" class="headerlink" title="其他项目"></a>其他项目</h3><h4 id="flutter版的文件管理器项目地址"><a href="#flutter版的文件管理器项目地址" class="headerlink" title="flutter版的文件管理器项目地址"></a><a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_file_manager.git">flutter版的文件管理器项目地址</a></h4><h4 id="flutter入门widget的使用。带你认识flutter-widgets。根据flutter中文网widgets目录进行编写的一个库。"><a href="#flutter入门widget的使用。带你认识flutter-widgets。根据flutter中文网widgets目录进行编写的一个库。" class="headerlink" title="flutter入门widget的使用。带你认识flutter widgets。根据flutter中文网widgets目录进行编写的一个库。"></a><a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_widgets">flutter入门widget的使用。</a>带你认识flutter widgets。根据flutter中文网widgets目录进行编写的一个库。</h4>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/01/17/flutter%20widget%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8%E4%B9%8B%E4%B8%80%EF%BC%88%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="long">
      <meta itemprop="description" content="小龙仔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="long">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/17/flutter%20widget%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8%E4%B9%8B%E4%B8%80%EF%BC%88%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6%EF%BC%89/" class="post-title-link" itemprop="url">flutter widget入门使用之一（基础组件）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-01-17 13:35:59" itemprop="dateCreated datePublished" datetime="2019-01-17T13:35:59+08:00">2019-01-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>学习flutter有几个月的时间了，flutter也已经发布了1.0版本，所以自己也想把这段时间学习的东西做个总结，这里做一个入门的Widgets使用总结。网上的学习资料也有很多，希望我的文章也能对大家有所帮助。<br>笔者在刚开始学习flutter的时候，看着官网的介绍，却不知道代码怎么写，呈现的效果是怎样的。虽然有官方的Gallery示例代码，但是那些代码写的太复杂，对于初学者来说看的就很懵。所以我计划写这样一个项目（<a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_widgets">项目github地址</a>），是根据flutter中文网的<a target="_blank" rel="noopener" href="https://flutterchina.club/widgets/">widgets目录</a>来进行编写的。主要是展示出某个widget的简单使用方法，一些常用属性的介绍，显示在界面上是什么样的效果。并不过于仔细剖析一个widget的方方面面，只是作为入门。<br>大家在学习的时候，可以对照flutter中文网的widgets目录和运行项目以及项目代码进行学习。本项目不追求界面的美化程度，仅仅是想展现出某个widget的最简单用法。这个项目适用于刚入门想学习flutter的小伙伴。错误之处在所难免，如有发现请大家提出来，我进行修改，谢谢！<br>PS：flutter安装等前期准备工作在这里就不介绍了，可以直接看官网教程。下面开始第一部分。</p>
<h2 id="基础组件"><a href="#基础组件" class="headerlink" title="基础组件"></a>基础组件</h2><h6 id="1-Container"><a href="#1-Container" class="headerlink" title="1. Container"></a>1. Container</h6><p>Container是一个拥有绘制、定位、调整大小的widget。类似于html中的div，最简单的一个Container就是<code>Container()</code>，在界面中什么也不会显示。需要给他指定宽、高和颜色等才可以看得出效果，或者在Container中放了其他自身有高度的widget才会显示出来。<br>示例代码：<br>显示一个高100，宽100，颜色为Color(0xff63d6fb)的正方形</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Container(</span><br><span class="line">  height: <span class="number">100.0</span>,</span><br><span class="line">  width: <span class="number">100.0</span>,</span><br><span class="line">  color: Color(<span class="number">0xff63d6fb</span>),</span><br><span class="line"> ),</span><br></pre></td></tr></table></figure>
<p>Container有以下常用属性：<br><code>alignment</code>：用于定位子元素（child）的位置。<br><code>decoration</code>：装饰，可以为Container添加边框<code>border</code>、边框圆角<code>borderRadius</code>、阴影<code>boxShadow</code>、背景图<code>image</code>、渐变色<code>gradient</code>、形状<code>shape</code>、背景色<code>color</code>等，注意在使用了装饰时，Container的color属性将不可用，取而代之的是装饰内的color属性。<br><code>constraints</code>:对Container的约束，可以设置最大宽高、最小宽高。<br><code>transform</code>：对Container进行转换。</p>
<h6 id="2-Row"><a href="#2-Row" class="headerlink" title="2. Row"></a>2. Row</h6><p>行布局，用于在水平方向上排列元素。如在一行中排放两个Container。<br>示例代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Row(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.spaceEvenly, <span class="comment">// 主轴方向（横向）对齐方式</span></span><br><span class="line">  crossAxisAlignment: CrossAxisAlignment.start, <span class="comment">// 交叉轴（竖直）对其方式</span></span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    Container(</span><br><span class="line">      height: <span class="number">100.0</span>,</span><br><span class="line">      width: <span class="number">100.0</span>,</span><br><span class="line">      color: Colors.red,</span><br><span class="line">     ),</span><br><span class="line">    Container(</span><br><span class="line">      height: <span class="number">100.0</span>,</span><br><span class="line">      width: <span class="number">100.0</span>,</span><br><span class="line">      color: Colors.black,</span><br><span class="line">     ),</span><br><span class="line">  ],</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<p>Row中排列的widget不会滚动，超出一行的范围时会有溢出。如果你希望它具有滚动效果，可以考虑使用ListView，同理Column也是一样，只需要设置ListView的方向即可。</p>
<h6 id="3-Column"><a href="#3-Column" class="headerlink" title="3. Column"></a>3. Column</h6><p>列布局，用于在竖直方向上排列元素，如在一列中排放两个Container。<br>示例代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.spaceEvenly, <span class="comment">// 主轴方向（竖直）对齐方式</span></span><br><span class="line">  crossAxisAlignment: CrossAxisAlignment.start, <span class="comment">// 交叉轴（横向）对其方式</span></span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    Container(</span><br><span class="line">      height: <span class="number">100.0</span>,</span><br><span class="line">      width: <span class="number">100.0</span>,</span><br><span class="line">      color: Colors.red,</span><br><span class="line">     ),</span><br><span class="line">    Container(</span><br><span class="line">      height: <span class="number">100.0</span>,</span><br><span class="line">      width: <span class="number">100.0</span>,</span><br><span class="line">      color: Colors.black,</span><br><span class="line">     ),</span><br><span class="line">  ],</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<h6 id="4-Image"><a href="#4-Image" class="headerlink" title="4. Image"></a>4. Image</h6><p>显示图片的Widget，Image能够从ImageProvider、项目资源、储存卡文件、网络和Uint8List中获取图像。这里介绍2种比较常用的方式。<br>示例代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载项目资源图片</span></span><br><span class="line">Image.asset(<span class="string">&#x27;assets/images/1.jpg&#x27;</span>,),</span><br><span class="line"><span class="comment">// 加载网络资源图片</span></span><br><span class="line">Image.network(</span><br><span class="line">  <span class="string">&#x27;https://avatars2.githubusercontent.com/u/37101820?s=400&amp;u=4c6356d8d94322a7684909af9594149d3c83d433&amp;v=4&#x27;</span>,</span><br><span class="line">  width: <span class="number">200.0</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure>

<h6 id="5-Text"><a href="#5-Text" class="headerlink" title="5. Text"></a>5. Text</h6><p>显示单一格式的文本Widget，该小部件显示单个样式的文本字符串，最简单的使用是</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Text(<span class="string">&#x27;这是一行文本内容！&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>下面来看一下Text的一些常用属性：<br><code>style</code>:样式，他是一个<code>TextStyle</code>，里面能够设置文本内容的颜色<code>color</code>、文字大小<code>fontSize</code>、字重<code>fontWeight</code>、文字样式<code>fontStyle</code>、字体<code>fontFamily</code>、文字装饰<code>decoration</code>、文本对其方式<code>textAlign</code>、最大行数<code>maxLines</code>、单词间距<code>wordSpacing</code>、字符间距<code>letterSpacing</code>等。<br>示例代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Text(</span><br><span class="line">  <span class="string">&#x27;更改字体颜色&#x27;</span>,</span><br><span class="line">  style: TextStyle(color: Colors.red),</span><br><span class="line">),</span><br><span class="line">Text(</span><br><span class="line">  <span class="string">&#x27;更改字体大小、加粗、斜体&#x27;</span>,</span><br><span class="line">  style: TextStyle(</span><br><span class="line">    fontSize: <span class="number">26.0</span>,</span><br><span class="line">    fontWeight: FontWeight.bold,</span><br><span class="line">    fontStyle: FontStyle.italic,</span><br><span class="line">    ),</span><br><span class="line">),</span><br><span class="line">Text(</span><br><span class="line">  <span class="string">&#x27;使用字体资源&#x27;</span>,</span><br><span class="line">  style: TextStyle(fontSize: <span class="number">20.0</span>, fontFamily: <span class="string">&#x27;pmzd&#x27;</span>),</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<p>效果的展示及更多代码，请查看项目源码。</p>
<h6 id="6-Icon"><a href="#6-Icon" class="headerlink" title="6. Icon"></a>6. Icon</h6><p>一个Material Design风格的小图标。这是flutter内置的图表库，里面包含了很多图标资源。<br>示例代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Icon(</span><br><span class="line">  Icons.ac_unit,</span><br><span class="line">  size: <span class="number">60.0</span>,</span><br><span class="line">  color: Colors.lightBlueAccent,</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<p>示例代码显示了一个大小为60的雪花图标，并设置了颜色。如果想让小图标可以相应点击事件，可以使用<code>IconButton</code>。</p>
<h6 id="7-RaisedButton"><a href="#7-RaisedButton" class="headerlink" title="7. RaisedButton"></a>7. RaisedButton</h6><p>Material Design风格的按钮，点击有水波纹的效果。<br>示例代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RaisedButton(</span><br><span class="line">  textColor: Colors.white,</span><br><span class="line">  color: Colors.blue,</span><br><span class="line">  child: Text(<span class="string">&#x27;改变文本、背景颜色&#x27;</span>),</span><br><span class="line">  onPressed: () &#123;&#125;,</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<p>常用属性解析：<br><code>color</code>：按钮背景颜色<br><code>textColor</code>：文本颜色<br><code>disabledTextColor</code>：不可点击状态的文本颜色<br><code>splashColor</code>：水波纹颜色<br><code>highlightColor</code>：按下按钮时高亮的颜色<br><code>elevation</code>：阴影<br><code>highlightElevation</code>：高亮时的阴影<br><code>disabledElevation</code>：不可点击状态的阴影<br><code>child</code>：子元素，通常放一个Text<br><code>shape</code>：形状，可设置圆角效果<br><code>onPressed</code>：点击事件</p>
<h6 id="8-Scaffold"><a href="#8-Scaffold" class="headerlink" title="8. Scaffold"></a>8. Scaffold</h6><p>脚手架Widget，是Material Design布局结构的基本实现。可以看到在项目中，每一个页面的build里面都return了一个Scaffold，它包含了应用标题栏<code>appBar</code>、主题部分<code>body</code>、侧滑窗口<code>drawer</code>、浮动按钮<code>floatingActionButton</code>、底部导航栏<code>bottomNavigationBar</code>等，这些事实一个APP页面常用的部分。可以根据需求选择自己需要的部分。</p>
<h6 id="9-Appbar"><a href="#9-Appbar" class="headerlink" title="9. Appbar"></a>9. Appbar</h6><p>应用标题栏，由工具栏和其他小部件组成，例如<code>TabBar</code>和<code>FlexibleSpaceBar</code>。<br>在标题栏可以显示当前页面的<code>title</code>，前导图标<code>leading</code>，若页面是从其他页面跳转过来的，会默认在该页面添加一个返回上一页的<code>leading</code>。<br>常用属性解析：<br><code>title</code>：标题<br><code>centerTitle</code>：标题是否居中<br><code>elevation</code>：阴影<br><code>leading</code>：前导小部件<br><code>actions</code>：在title之后的部件，可以显示多个。<br><code>bottom</code>：显示在应用栏底部的小部件<br><code>backgroundColor</code>：背景颜色</p>
<h6 id="10-FlutterLogo"><a href="#10-FlutterLogo" class="headerlink" title="10. FlutterLogo"></a>10. FlutterLogo</h6><p>以Widget的形式显示一个Flutter的Logo，没啥特别的。</p>
<h6 id="11-Placeholder"><a href="#11-Placeholder" class="headerlink" title="11. Placeholder"></a>11. Placeholder</h6><p>一个绘制了一个盒子的widget，代表以后有widget将会被添加到该盒子中，就是占一个位置。可能由于个人编程习惯，觉得这个没什么太大用处<br>部分页面效果如下：<br><img src="https://upload-images.jianshu.io/upload_images/13443233-9c157b6437761ee6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/280" alt="Container"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/13443233-e3f7c45309d4a3b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240" alt="Text"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/13443233-fc4bb6cc325a2b34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240" alt="Icon"></p>
<h2 id="项目源码在我的GitHub-flutter-widgets项目地址"><a href="#项目源码在我的GitHub-flutter-widgets项目地址" class="headerlink" title="项目源码在我的GitHub flutter_widgets项目地址"></a>项目源码在我的GitHub <a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_widgets">flutter_widgets项目地址</a></h2><p>项目与教程有时间会继续更新，直至整个widgets目录完成。喜欢的给个 ★star 支持，谢谢！如有错误之处或问题也可以在这里留言或者提issue给我~</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/11/07/flutter%E7%89%88%E7%9A%84%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="long">
      <meta itemprop="description" content="小龙仔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="long">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/07/flutter%E7%89%88%E7%9A%84%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%99%A8/" class="post-title-link" itemprop="url">flutter版的文件管理器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-07 09:20:17" itemprop="dateCreated datePublished" datetime="2018-11-07T09:20:17+08:00">2018-11-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>第一次写文章，作为自己学习flutter过程中做一些记录吧</p>
<p>最近在项目的过程中涉及到要访问内存卡，并且打开文件的情况。调用原生的文件管理器效果不太理想，所以想着用flutter自定义一个。好了，开始吧！</p>
<h3 id="创建一个flutter项目开始写代码。"><a href="#创建一个flutter项目开始写代码。" class="headerlink" title="创建一个flutter项目开始写代码。"></a><strong>创建一个flutter项目开始写代码。</strong></h3><p>要访问SD卡，首先读取权限肯定是要有的，不然写再多代码都是无用功。<br>在AndroidManifest.xml文件中添加<br><code>&lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;</code></p>
<p>新建一个dart文件<code>file_manager.dart</code><br>这里需要使用到一个插件<code>path_provider</code>用来获取SD卡根路径（不嫌麻烦自己写原生也可以），在<code>pubspec.yaml</code>文件里添加相关依赖即可<code>path_provider: ^0.4.1</code>。</p>
<p>然后在初始化函数使用<code>String sDCardDir = (await getExternalStorageDirectory()).path;</code>获得SD卡的根路径（一定要在初始化函数中就调用，不然运行之后连个路径都没），从这个路径就可以找出SD卡的所有文件和文件夹。<br>拿到这个路径后使用<code>directory.listSync()</code>会自动找出当前目录下所有文件和文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;FileSystemEntity&gt; files &#x3D; [];</span><br><span class="line"></span><br><span class="line">var directory &#x3D; Directory(sDCardDir);</span><br><span class="line">files &#x3D; directory.listSync();</span><br></pre></td></tr></table></figure>
<p>把SD卡根目录下的所有文件、文件夹都存放到<code>files</code>中，这也是这个文件管理器最核心的方法，传入根目录路径就能找出根路径下的所有文件和文件夹，那把其中一个文件夹的路径再传进去（点击一个文件夹的时候，传递该文件夹路径），就能找出这个文件夹里的所有文件和文件夹啦~</p>
<p>页面显示的时候使用了<code>ListView</code>布局，因为文件数量不确定，也可能会很大，所以使用了<code>ListView.builder</code>进行构建。具体代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">  controller: controller,</span><br><span class="line">  itemCount: files.length,</span><br><span class="line">  itemBuilder: (BuildContext context, int index) &#123;</span><br><span class="line">    return buildListViewItem(files[index]);</span><br><span class="line">  &#125;,</span><br><span class="line">),</span><br></pre></td></tr></table></figure>
<p>返回的<code>buildListViewItem</code>就是具体的布局，简单使用<code>ListTile</code>就可以完成比较好看的显示效果了。代码还是贴上来：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Column(</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          ListTile(</span><br><span class="line">            leading: Image.asset(selectIcon(isFile, file)),</span><br><span class="line">            title: Row(</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                Expanded(child: Text(file.path.substring(file.parent.path.length + 1))),</span><br><span class="line">                isFile</span><br><span class="line">                    ? Container()</span><br><span class="line">                    : Text(</span><br><span class="line">                        &#39;$length项&#39;,</span><br><span class="line">                        style: TextStyle(color: Colors.grey),</span><br><span class="line">                      )</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">            subtitle: isFile</span><br><span class="line">                ? Text(</span><br><span class="line">                    &#39;$&#123;getFileLastModifiedTime(file)&#125;  $&#123;getFileSize(file)&#125;&#39;,</span><br><span class="line">                    style: TextStyle(fontSize: 12.0),</span><br><span class="line">                  )</span><br><span class="line">                : null,</span><br><span class="line">            trailing: isFile ? null : Icon(Icons.chevron_right),</span><br><span class="line">          ),</span><br><span class="line">          Padding(</span><br><span class="line">            padding: EdgeInsets.symmetric(horizontal: 14.0),</span><br><span class="line">            child: Divider(</span><br><span class="line">              height: 1.0,</span><br><span class="line">            ),</span><br><span class="line">          )</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br></pre></td></tr></table></figure>
<p>那如何判断这是一个文件还是文件夹呢？这里有一个方法<br><code>var isFile = FileSystemEntity.isFileSync(file.path);</code><br>这是一个bool类型的值，true表示是文件，false就是文件夹啦。<br>在后面的显示上就可以通过这个来区分了。<br>还有一些页面显示美化的代码就不贴了，后面有项目地址可以自己下载下来看看。</p>
<h3 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a><strong>打开文件</strong></h3><p>文件管理器，看到的文件应该要能打开吧。下面就是判断点击的是文件时，要弹出提示用什么应用去打开，要写一点原生，不过也不难。<br>自己写一个通道的方法，去调用<br><code>file_manager.dart</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MethodChannel _channel &#x3D; MethodChannel(&#39;openFileChannel&#39;);</span><br><span class="line"></span><br><span class="line">openFile(String path) &#123;</span><br><span class="line">    final Map&lt;String, dynamic&gt; args &#x3D; &lt;String, dynamic&gt;&#123;&#39;path&#39;: path&#125;;</span><br><span class="line">    _channel.invokeMethod(&#39;openFile&#39;, args);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>然后在<code>MainActivity.java</code>文件中定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">private static Context mContext &#x3D; null;</span><br><span class="line">private static final String METHOD_CHANNEL &#x3D; &quot;openFileChannel&quot;;</span><br></pre></td></tr></table></figure>
<p><code>&quot;openFileChannel&quot;</code>名字要对应一致<br>然后在onCreate方法中增加以下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">new MethodChannel(getFlutterView(), METHOD_CHANNEL).setMethodCallHandler(</span><br><span class="line">                new MethodCallHandler() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void onMethodCall(MethodCall methodCall, MethodChannel.Result result) &#123;</span><br><span class="line">                        if (methodCall.method.equals(&quot;openFile&quot;)) &#123;</span><br><span class="line">                            String path &#x3D; methodCall.argument(&quot;path&quot;);</span><br><span class="line">                            openFile(mContext, path);</span><br><span class="line">                            result.success(&quot;&quot;);</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            result.notImplemented();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        );</span><br></pre></td></tr></table></figure>
<p>方法名为<code>openFile</code>，其实只有一个方法好像不用指定也是可以的，不过为了规范一点，还是写上比较好。<br>dart那边传给Java层的是一个文件的路径，然后调用openFile()方法，方法实现如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">private void openFile(Context context, String path) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if (!path.contains(&quot;file:&#x2F;&#x2F;&quot;)) &#123;</span><br><span class="line">                path &#x3D; &quot;file:&#x2F;&#x2F;&quot; + path;</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F;获取文件类型</span><br><span class="line">            String[] nameType &#x3D; path.split(&quot;\\.&quot;);</span><br><span class="line">            String mimeType &#x3D; MimeTypeMap.getSingleton().getMimeTypeFromExtension(nameType[1]);</span><br><span class="line"></span><br><span class="line">            Intent intent &#x3D; new Intent();</span><br><span class="line">            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">            intent.setAction(Intent.ACTION_VIEW);</span><br><span class="line">            &#x2F;&#x2F;设置文件的路径和文件类型</span><br><span class="line">            intent.setDataAndType(Uri.parse(path), mimeType);</span><br><span class="line">            &#x2F;&#x2F;跳转</span><br><span class="line">            context.startActivity(intent);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>使用Intent的方式去打开，这里还是加上try…catch…吧，因为有些文件类型好像会报错，具体原因还没去深究，应该是一些系统文件（有些连文件后缀都没…）<br>整个文件管理器的实现主要方法就到这里了<br>实现的界面如下<br><img src="https://upload-images.jianshu.io/upload_images/13443233-2c817fa4ca3c43a5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="界面"></p>
<p>项目的代码已经上传到我的GitHub，如果觉得对你有帮助欢迎star，同时也会继续更新完善 </p>
<h2 id="flutter版的文件管理器项目地址"><a href="#flutter版的文件管理器项目地址" class="headerlink" title="flutter版的文件管理器项目地址"></a><a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_file_manager.git">flutter版的文件管理器项目地址</a></h2><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="flutter入门widget的使用。带你认识flutter-widgets。根据flutter中文网widgets目录进行编写的一个库。"><a href="#flutter入门widget的使用。带你认识flutter-widgets。根据flutter中文网widgets目录进行编写的一个库。" class="headerlink" title="flutter入门widget的使用。带你认识flutter widgets。根据flutter中文网widgets目录进行编写的一个库。"></a><a target="_blank" rel="noopener" href="https://github.com/huang-weilong/flutter_widgets">flutter入门widget的使用。带你认识flutter widgets。根据flutter中文网widgets目录进行编写的一个库。</a></h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="long"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">long</p>
  <div class="site-description" itemprop="description">小龙仔</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/huang-weilong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;huang-weilong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">long</span>
</div>
  <div class="powered-by">由 <a href="https://github.com/huang-weilong" class="theme-link" rel="noopener" target="_blank">long</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
